# Kedro DataCatalog Definition
# conf/base/catalog.yml

# ============================================================
# Layer 01: Raw Data (Provider-specific input)
# ============================================================

raw_claude_conversations:
  type: partitions.PartitionedDataset
  path: data/01_raw/claude
  dataset:
    type: obsidian_etl.datasets.BinaryDataset
  filename_suffix: ".zip"
  metadata:
    kedro-viz:
      layer: raw

raw_openai_conversations:
  type: partitions.PartitionedDataset
  path: data/01_raw/openai
  dataset:
    type: obsidian_etl.datasets.BinaryDataset
  filename_suffix: ".zip"
  metadata:
    kedro-viz:
      layer: raw

# raw_github_posts is NOT defined here - clone_github_repo returns dict[str, Callable]
# in memory, so Kedro auto-creates a MemoryDataset for it.

# ============================================================
# Layer 02: Intermediate (Extract output - unified format)
# ============================================================

parsed_items:
  type: partitions.PartitionedDataset
  path: data/02_intermediate/parsed
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  overwrite: false
  metadata:
    kedro-viz:
      layer: intermediate

# Resume version (read-only reference to same location)
existing_parsed_items:
  type: partitions.PartitionedDataset
  path: data/02_intermediate/parsed
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  load_args:
    # Read-only mode
  metadata:
    kedro-viz:
      layer: intermediate

# ============================================================
# Layer 03: Primary (Transform output - LLM-enriched)
# ============================================================

transformed_items_with_knowledge:
  type: partitions.PartitionedDataset
  path: data/03_primary/transformed_knowledge
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  overwrite: false
  metadata:
    kedro-viz:
      layer: primary

# Resume version (read-only reference to same location)
existing_transformed_items_with_knowledge:
  type: partitions.PartitionedDataset
  path: data/03_primary/transformed_knowledge
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  metadata:
    kedro-viz:
      layer: primary

transformed_items_with_metadata:
  type: partitions.PartitionedDataset
  path: data/03_primary/transformed_metadata
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  overwrite: false
  metadata:
    kedro-viz:
      layer: primary

# ============================================================
# Layer 07: Model Output (Final Markdown + Organized)
# ============================================================

markdown_notes:
  type: partitions.PartitionedDataset
  path: data/07_model_output/notes
  dataset:
    type: text.TextDataset
  filename_suffix: ".md"
  overwrite: false
  metadata:
    kedro-viz:
      layer: model_output

review_notes:
  type: partitions.PartitionedDataset
  path: data/07_model_output/review
  dataset:
    type: text.TextDataset
  filename_suffix: ".md"
  overwrite: false
  metadata:
    kedro-viz:
      layer: model_output

classified_items:
  type: partitions.PartitionedDataset
  path: data/07_model_output/classified
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  overwrite: false
  metadata:
    kedro-viz:
      layer: model_output

# Resume version (read-only reference to same location)
existing_classified_items:
  type: partitions.PartitionedDataset
  path: data/07_model_output/classified
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  metadata:
    kedro-viz:
      layer: model_output

topic_extracted_items:
  type: partitions.PartitionedDataset
  path: data/07_model_output/topic_extracted
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  overwrite: false
  metadata:
    kedro-viz:
      layer: model_output

normalized_items:
  type: partitions.PartitionedDataset
  path: data/07_model_output/normalized
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  overwrite: false
  metadata:
    kedro-viz:
      layer: model_output

cleaned_items:
  type: partitions.PartitionedDataset
  path: data/07_model_output/cleaned
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  overwrite: false
  metadata:
    kedro-viz:
      layer: model_output

vault_determined_items:
  type: partitions.PartitionedDataset
  path: data/07_model_output/vault_determined
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  overwrite: false
  metadata:
    kedro-viz:
      layer: model_output

organized_items:
  type: partitions.PartitionedDataset
  path: data/07_model_output/organized
  dataset:
    type: json.JSONDataset
  filename_suffix: ".json"
  overwrite: false
  metadata:
    kedro-viz:
      layer: model_output

organized_notes:
  type: partitions.PartitionedDataset
  path: data/07_model_output/organized
  dataset:
    type: text.TextDataset
  filename_suffix: ".md"
  overwrite: false
  metadata:
    kedro-viz:
      layer: model_output

organized_files:
  type: partitions.PartitionedDataset
  path: data/07_model_output/organized
  dataset:
    type: text.TextDataset
  filename_suffix: ".md"
  overwrite: false
  metadata:
    kedro-viz:
      layer: model_output

